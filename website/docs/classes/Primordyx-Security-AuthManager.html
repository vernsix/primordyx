<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
            <title>Primordyx Framework Documentation</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">Primordyx Framework Documentation</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category -namespaces">
            <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="namespaces/primordyxcli.html" class="">PrimordyxCLI</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="namespaces/primordyx.html" class="">Primordyx</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="namespaces/primordyx-config.html" class="">Config</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-data.html" class="">Data</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-database.html" class="">Database</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-events.html" class="">Events</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-geo.html" class="">Geo</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-http.html" class="">Http</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-mail.html" class="">Mail</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-routing.html" class="">Routing</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-security.html" class="">Security</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-system.html" class="">System</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-time.html" class="">Time</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-utils.html" class="">Utils</a>
                
            </li>
                    <li>
                <a href="namespaces/primordyx-view.html" class="">View</a>
                
            </li>
            </ul>

                        </section>
                <section class="phpdocumentor-sidebar__category -packages">
            <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Primordyx.html" class="">Primordyx</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Application.html" class="">Application</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/PrimordyxExamples.html" class="">PrimordyxExamples</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category -reports">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category -indices">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                <section>
                                        <ul class="phpdocumentor-breadcrumbs">
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/primordyx.html">Primordyx</a></li>
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/primordyx-security.html">Security</a></li>
    </ul>

    <article class="phpdocumentor-element -class">
        <h2 class="phpdocumentor-content__title">
    AuthManager

    
            <div class="phpdocumentor-element__package">
            in package
            <ul class="phpdocumentor-breadcrumbs">
                                    <li class="phpdocumentor-breadcrumb"><a href="packages/Primordyx.html">Primordyx</a></li>
                            </ul>
        </div>
    
    
    </h2>

<div class="phpdocumentor-label-line">


</div>

        <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">84</span>

    </aside>

            <p class="phpdocumentor-summary">Comprehensive Authentication and Authorization System for Primordyx Applications</p>


    <section class="phpdocumentor-description"><p>Provides secure session management, role-based access control, and protection against
common attack vectors like brute force login attempts. Built specifically for the
Primordyx framework with seamless Safe class integration and flexible model support.</p>
<h2>Core Features</h2>
<ul>
<li><strong>Secure Session Management</strong> - Uses Safe class for tamper-resistant session storage</li>
<li><strong>Failed Login Protection</strong> - Automatic account lockout after configurable failed attempts</li>
<li><strong>Role-Based Authorization</strong> - Flexible permission system using authorization words</li>
<li><strong>Session Timeout</strong> - Automatic logout after configurable inactivity periods</li>
<li><strong>Flash Messaging</strong> - Built-in support for user notifications across redirects</li>
<li><strong>Configurable URLs</strong> - Customizable redirect destinations for all authentication scenarios</li>
<li><strong>Model Agnostic</strong> - Works with any Model implementation following Primordyx conventions</li>
<li><strong>Attack Prevention</strong> - Protection against brute force, session fixation, and timing attacks</li>
</ul>
<h2>Security Architecture</h2>
<ul>
<li>Password verification using PHP's secure <code class="prettyprint">password_verify()</code> function</li>
<li>Failed attempt tracking with temporary account lockouts</li>
<li>Session data stored via Safe class (tamper-resistant)</li>
<li>Automatic cleanup of expired sessions and stale return URLs</li>
<li>Authorization words normalized to lowercase for consistent checking</li>
</ul>
<h2>Quick Start Integration</h2>
<pre class="prettyprint"><code class="language-php">// Bootstrap configuration
AuthManager::config([
    'login_url' =&gt; '/auth/login.php',
    'max_login_attempts' =&gt; 5,
    'lockout_time' =&gt; 900,
    'timeout_seconds' =&gt; 3600,
    'after_logout_url' =&gt; '/'
]);

// Set required models
AuthManager::userModel(new User());
AuthManager::userAuthWordsModel(new UserAuthWords());
</code></pre>
<h2>Common Usage Patterns</h2>
<pre class="prettyprint"><code class="language-php">// Page protection
AuthManager::setReturnUrl($_SERVER['REQUEST_URI']);
AuthManager::requireAuth('admin');

// Login processing
AuthManager::login($_POST['username'], $_POST['password']); // Never returns

// Authorization checks
if (AuthManager::isAuthorizedAny(['admin', 'manager'])) {
    showLeadershipDashboard();
}
</code></pre>
</section>


    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="classes/Primordyx-Data-Safe.html"><abbr title="\Primordyx\Data\Safe">Safe</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"><p>For secure session management</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"><p>For database model requirements</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                            </dl>





<h3 id="toc">
    Table of Contents
    <a href="classes/Primordyx-Security-AuthManager.html#toc" class="headerlink"><i class="fas fa-link"></i></a>

</h3>









<h4 id="toc-properties">
    Properties
    <a href="classes/Primordyx-Security-AuthManager.html#toc-properties" class="headerlink"><i class="fas fa-link"></i></a>

</h4>
<dl class="phpdocumentor-table-of-contents">
            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_afterLogoutUrl">$afterLogoutUrl</a>
    <span>
                        &nbsp;: string            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_lockedOutUrl">$lockedOutUrl</a>
    <span>
                        &nbsp;: string            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_lockoutTime">$lockoutTime</a>
    <span>
                        &nbsp;: int            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_loginUrl">$loginUrl</a>
    <span>
                        &nbsp;: string            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_maxLoginAttempts">$maxLoginAttempts</a>
    <span>
                        &nbsp;: int            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_timeoutSeconds">$timeoutSeconds</a>
    <span>
                        &nbsp;: int            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_timeoutUrl">$timeoutUrl</a>
    <span>
                        &nbsp;: string            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_userAuthWordsModel">$userAuthWordsModel</a>
    <span>
                        &nbsp;: <a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null            </span>
</dt>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#property_userModel">$userModel</a>
    <span>
                        &nbsp;: <a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null            </span>
</dt>

    </dl>

<h4 id="toc-methods">
    Methods
    <a href="classes/Primordyx-Security-AuthManager.html#toc-methods" class="headerlink"><i class="fas fa-link"></i></a>

</h4>
<dl class="phpdocumentor-table-of-contents">
            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_afterLogoutUrl">afterLogoutUrl()</a>
    <span>
                                &nbsp;: string    </span>
</dt>
<dd>Get or set the URL where users are redirected after successful logout</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_config">config()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Configure multiple AuthManager settings at once for streamlined setup</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_forceLogin">forceLogin()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Force user to login page with optional message - never returns</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_getFlash">getFlash()</a>
    <span>
                                &nbsp;: array{type: string, message: string}|null    </span>
</dt>
<dd>Retrieve and consume flash message from session (removes after retrieval)</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_getReturnUrl">getReturnUrl()</a>
    <span>
                                &nbsp;: string|null    </span>
</dt>
<dd>Get and consume the stored return URL for post-login redirect</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_getUserAuthWords">getUserAuthWords()</a>
    <span>
                                &nbsp;: array&lt;string|int, string&gt;    </span>
</dt>
<dd>Get array of authorization words (roles/permissions) for the current user</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_isAuthorized">isAuthorized()</a>
    <span>
                                &nbsp;: bool    </span>
</dt>
<dd>Check if current authenticated user has a specific authorization word (role/permission)</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAll">isAuthorizedAll()</a>
    <span>
                                &nbsp;: bool    </span>
</dt>
<dd>Check if user has all of the specified authorization words (AND logic)</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAny">isAuthorizedAny()</a>
    <span>
                                &nbsp;: bool    </span>
</dt>
<dd>Check if user has at least one of the specified authorization words (OR logic)</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_isLoggedIn">isLoggedIn()</a>
    <span>
                                &nbsp;: bool    </span>
</dt>
<dd>Check if user is currently authenticated with a valid, non-expired session</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_lockedOutUrl">lockedOutUrl()</a>
    <span>
                                &nbsp;: string    </span>
</dt>
<dd>Get or set the URL where locked-out users are redirected for notification</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_lockoutTime">lockoutTime()</a>
    <span>
                                &nbsp;: int    </span>
</dt>
<dd>Get or set the lockout duration in seconds after exceeding max login attempts</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_login">login()</a>
    <span>
                                &nbsp;: never    </span>
</dt>
<dd>Attempt to authenticate user with username and password - always redirects, never returns</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_loginUrl">loginUrl()</a>
    <span>
                                &nbsp;: string    </span>
</dt>
<dd>Get or set the login URL where users are redirected for authentication</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_logout">logout()</a>
    <span>
                                &nbsp;: never    </span>
</dt>
<dd>Log out current user, clean up all session data, and redirect - never returns</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_maxLoginAttempts">maxLoginAttempts()</a>
    <span>
                                &nbsp;: int    </span>
</dt>
<dd>Get or set the maximum login attempts before triggering account lockout</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_requireAuth">requireAuth()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Enforce authentication and optional authorization requirements - redirects if not met</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_setFlash">setFlash()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Set flash message for display after redirect (consumed on next request)</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_setReturnUrl">setReturnUrl()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Set return URL for post-login redirect to user&#039;s intended destination</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_timeoutSeconds">timeoutSeconds()</a>
    <span>
                                &nbsp;: int    </span>
</dt>
<dd>Get or set the session timeout duration in seconds for inactivity-based logout</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_timeoutUrl">timeoutUrl()</a>
    <span>
                                &nbsp;: string    </span>
</dt>
<dd>Get or set the URL where users are redirected when their session times out</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_user">user()</a>
    <span>
                                &nbsp;: <a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null    </span>
</dt>
<dd>Get the current authenticated user&#039;s model instance from the database</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_userAuthWordsModel">userAuthWordsModel()</a>
    <span>
                                &nbsp;: <a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null    </span>
</dt>
<dd>Get or set the user authorization words model for role-based access control</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_userModel">userModel()</a>
    <span>
                                &nbsp;: <a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null    </span>
</dt>
<dd>Get or set the user model instance for database authentication operations</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_ensureModelsConfigured">ensureModelsConfigured()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Ensure required models are configured before performing database operations</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_handleFailedLogin">handleFailedLogin()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Handle failed login attempt by updating attempt counters and applying lockouts</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a class="" href="classes/Primordyx-Security-AuthManager.html#method_handleSuccessfulLogin">handleSuccessfulLogin()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Handle successful login by resetting failure counters and creating session</dd>

    </dl>



        

        
    <section class="phpdocumentor-properties">
        <h3 class="phpdocumentor-elements__header" id="properties">
            Properties
            <a href="classes/Primordyx-Security-AuthManager.html#properties" class="headerlink"><i class="fas fa-link"></i></a>

        </h3>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_afterLogoutUrl">
        $afterLogoutUrl
        <a href="classes/Primordyx-Security-AuthManager.html#property_afterLogoutUrl" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">91</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">string</span>
    <span class="phpdocumentor-signature__name">$afterLogoutUrl</span>
     = <span class="phpdocumentor-signature__default-value">&#039;/&#039;</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_lockedOutUrl">
        $lockedOutUrl
        <a href="classes/Primordyx-Security-AuthManager.html#property_lockedOutUrl" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">90</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">string</span>
    <span class="phpdocumentor-signature__name">$lockedOutUrl</span>
     = <span class="phpdocumentor-signature__default-value">&#039;/locked.php&#039;</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_lockoutTime">
        $lockoutTime
        <a href="classes/Primordyx-Security-AuthManager.html#property_lockoutTime" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">89</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">int</span>
    <span class="phpdocumentor-signature__name">$lockoutTime</span>
     = <span class="phpdocumentor-signature__default-value">900</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_loginUrl">
        $loginUrl
        <a href="classes/Primordyx-Security-AuthManager.html#property_loginUrl" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">87</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">string</span>
    <span class="phpdocumentor-signature__name">$loginUrl</span>
     = <span class="phpdocumentor-signature__default-value">&#039;/login.php&#039;</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_maxLoginAttempts">
        $maxLoginAttempts
        <a href="classes/Primordyx-Security-AuthManager.html#property_maxLoginAttempts" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">88</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">int</span>
    <span class="phpdocumentor-signature__name">$maxLoginAttempts</span>
     = <span class="phpdocumentor-signature__default-value">5</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_timeoutSeconds">
        $timeoutSeconds
        <a href="classes/Primordyx-Security-AuthManager.html#property_timeoutSeconds" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">93</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">int</span>
    <span class="phpdocumentor-signature__name">$timeoutSeconds</span>
     = <span class="phpdocumentor-signature__default-value">3600</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_timeoutUrl">
        $timeoutUrl
        <a href="classes/Primordyx-Security-AuthManager.html#property_timeoutUrl" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">92</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type">string</span>
    <span class="phpdocumentor-signature__name">$timeoutUrl</span>
     = <span class="phpdocumentor-signature__default-value">&#039;/timeout.php&#039;</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_userAuthWordsModel">
        $userAuthWordsModel
        <a href="classes/Primordyx-Security-AuthManager.html#property_userAuthWordsModel" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">95</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
    <span class="phpdocumentor-signature__name">$userAuthWordsModel</span>
     = <span class="phpdocumentor-signature__default-value">null</span></code>

    
    
    

    

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
            -static                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_userModel">
        $userModel
        <a href="classes/Primordyx-Security-AuthManager.html#property_userModel" class="headerlink"><i class="fas fa-link"></i></a>

        <span class="phpdocumentor-element__modifiers">
                                            </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">94</span>

    </aside>

    
    
    <code class="phpdocumentor-code phpdocumentor-signature ">
        <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__static">static</span>    <span class="phpdocumentor-signature__type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
    <span class="phpdocumentor-signature__name">$userModel</span>
     = <span class="phpdocumentor-signature__default-value">null</span></code>

    
    
    

    

    

</article>
            </section>

            <section class="phpdocumentor-methods">
        <h3 class="phpdocumentor-elements__header" id="methods">
            Methods
            <a href="classes/Primordyx-Security-AuthManager.html#methods" class="headerlink"><i class="fas fa-link"></i></a>

        </h3>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_afterLogoutUrl">
        afterLogoutUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_afterLogoutUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">312</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the URL where users are redirected after successful logout</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">afterLogoutUrl</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When <code class="prettyprint">logout()</code> is called, users will be redirected to this URL after
their session data has been cleaned up.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the after logout URL and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_afterLogoutUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Destination</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::afterLogoutUrl();       // Get current URL
echo &quot;Post-logout: $current&quot;;                   // Shows '/' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Custom Goodbye Page</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::afterLogoutUrl('/goodbye.php');
echo &quot;Logout destination changed from: $old&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current after logout URL (if getting) or previous URL (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_config">
        config()
        <a href="classes/Primordyx-Security-AuthManager.html#method_config" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">153</span>

    </aside>

        <p class="phpdocumentor-summary">Configure multiple AuthManager settings at once for streamlined setup</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">config</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$config</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Provides bulk configuration of all AuthManager settings through a single method call.
This is the recommended approach for application bootstrap as it ensures all related
settings are configured together and provides better maintainability.</p>
<h2>Available Configuration Keys</h2>
<ul>
<li><code class="prettyprint">login_url</code> - Where to redirect users for authentication</li>
<li><code class="prettyprint">max_login_attempts</code> - Failed attempts before account lockout</li>
<li><code class="prettyprint">lockout_time</code> - Lockout duration in seconds</li>
<li><code class="prettyprint">locked_out_url</code> - Where to show lockout notification</li>
<li><code class="prettyprint">after_logout_url</code> - Destination after successful logout</li>
<li><code class="prettyprint">timeout_url</code> - Where to redirect on session timeout</li>
<li><code class="prettyprint">timeout_seconds</code> - Session inactivity timeout duration</li>
</ul>
<h2>Configuration Strategy</h2>
<p>Settings are applied individually using the respective setter methods, ensuring
consistency with individual configuration calls and maintaining backward compatibility.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$config</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Configuration array with the following supported keys:</p>
<ul>
<li>'login_url' (string): URL to redirect to for login (default: '/login.php')</li>
<li>'max_login_attempts' (int): Maximum failed attempts before lockout (default: 5)</li>
<li>'lockout_time' (int): Lockout duration in seconds (default: 900 = 15 minutes)</li>
<li>'locked_out_url' (string): URL to show when user is locked out (default: '/locked.php')</li>
<li>'after_logout_url' (string): URL to redirect after logout (default: '/')</li>
<li>'timeout_url' (string): URL to redirect on session timeout (default: '/timeout.php')</li>
<li>'timeout_seconds' (int): Session timeout in seconds (default: 3600 = 1 hour)</li>
</ul>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_config#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If invalid configuration values are provided</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Bootstrap Configuration</p>
<pre class="prettyprint"><code class="language-php">AuthManager::config([
    'login_url' =&gt; '/auth/login.php',           // Authentication entry point
    'max_login_attempts' =&gt; 3,                  // Lock after 3 failures
    'lockout_time' =&gt; 1800,                     // 30 minute lockout
    'locked_out_url' =&gt; '/auth/locked.php',     // Lockout notification page
    'after_logout_url' =&gt; '/goodbye.php',       // Post-logout destination
    'timeout_url' =&gt; '/auth/timeout.php',       // Session timeout page
    'timeout_seconds' =&gt; 7200                   // 2 hour session timeout
]);
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Production Security Configuration</p>
<pre class="prettyprint"><code class="language-php">AuthManager::config([
    'max_login_attempts' =&gt; 5,
    'lockout_time' =&gt; 900,          // 15 minutes
    'timeout_seconds' =&gt; 3600       // 1 hour timeout
]);
// Other settings remain at defaults
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_forceLogin">
        forceLogin()
        <a href="classes/Primordyx-Security-AuthManager.html#method_forceLogin" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1183</span>

    </aside>

        <p class="phpdocumentor-summary">Force user to login page with optional message - never returns</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">forceLogin</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$message</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Immediately redirects user to the configured login URL with an optional flash message.
This method is typically used when authentication is required but not present, or
when specific access requirements are not met.</p>
<h2>Redirect Process</h2>
<ul>
<li>Sets flash message (if provided) for user feedback</li>
<li>Redirects to configured login URL</li>
<li>Calls exit to stop script execution</li>
<li>Does NOT automatically set return URL (caller responsibility)</li>
</ul>
<h2>Usage Patterns</h2>
<ul>
<li>Call <code class="prettyprint">setReturnUrl()</code> first if you want user returned to current page</li>
<li>Provide descriptive message for better user experience</li>
<li>Use for both authentication and authorization failures</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$message</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional flash message to display on login page</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_forceLogin#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Simple Force Login</p>
<pre class="prettyprint"><code class="language-php">AuthManager::forceLogin();
// User redirected to login with default message
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>With Custom Message</p>
<pre class="prettyprint"><code class="language-php">AuthManager::forceLogin('Administrator access required.');
// User sees specific message explaining access requirement
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>With Return URL</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setReturnUrl('/admin/reports');
AuthManager::forceLogin('Please log in to view reports.');
// User returned to reports page after successful login
</code></pre>
</section>

                                    </dd>
                                            </dl>

    
    <section class="phpdocumentor-attributes">
        <h5 class="phpdocumentor-elements__header" id="attributes">
            Attributes <a href="classes/Primordyx-Security-AuthManager.html#method_forceLogin#attributes" class="headerlink"><i class="fas fa-link"></i></a>

        </h5>
                    <dl class="phpdocumentor-argument-list">
    <dt class="phpdocumentor-argument-list__entry">
        #[<abbr title="\JetBrains\PhpStorm\NoReturn">NoReturn</abbr>]
    </dt>
    </dl>
            </section>

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">void</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>This method never returns - always redirects and calls exit</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_getFlash">
        getFlash()
        <a href="classes/Primordyx-Security-AuthManager.html#method_getFlash" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1007</span>

    </aside>

        <p class="phpdocumentor-summary">Retrieve and consume flash message from session (removes after retrieval)</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">getFlash</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array{type: string, message: string}|null</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Gets the current flash message and automatically removes it from the session,
ensuring it displays exactly once. Returns structured data with both message
type and content for easy rendering in templates.</p>
<h2>Auto-Consumption Behavior</h2>
<ul>
<li>Message is removed from session when this method is called</li>
<li>Subsequent calls return null until new flash message is set</li>
<li>Prevents accidental duplicate message display</li>
<li>Implements standard flash message pattern</li>
</ul>
<h2>Return Format</h2>
<p>Returns associative array with keys:</p>
<ul>
<li><code class="prettyprint">type</code> - Message type for CSS classes (success, error, warning, info)</li>
<li><code class="prettyprint">message</code> - The actual message content to display</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_getFlash#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Display Flash Message</p>
<pre class="prettyprint"><code class="language-php">$flash = AuthManager::getFlash();
if ($flash) {
    echo '&lt;div class=&quot;alert alert-' . htmlspecialchars($flash['type']) . '&quot;&gt;';
    echo htmlspecialchars($flash['message']);
    echo '&lt;/div&gt;';
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Template Integration</p>
<pre class="prettyprint"><code class="language-php">if ($flash = AuthManager::getFlash()) {
    displayAlert($flash['type'], $flash['message']);
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array{type: string, message: string}|null</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>Flash message data or null if no message exists</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_getReturnUrl">
        getReturnUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_getReturnUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1228</span>

    </aside>

        <p class="phpdocumentor-summary">Get and consume the stored return URL for post-login redirect</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">getReturnUrl</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string|null</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Retrieves the stored return URL from session and automatically removes it to prevent
reuse. This method is called internally by <code class="prettyprint">login()</code> to determine where to redirect
users after successful authentication.</p>
<h2>URL Lifecycle</h2>
<ul>
<li>URL is set via <code class="prettyprint">setReturnUrl()</code> before authentication</li>
<li>Persists through login process in Safe session storage</li>
<li>Retrieved and removed by this method after successful login</li>
<li>Returns null if no return URL was previously set</li>
</ul>
<h2>Security Notes</h2>
<ul>
<li>URL is automatically cleared to prevent session fixation attacks</li>
<li>Old return URLs are cleared on logout to prevent stale redirects</li>
<li>No validation performed on URL - caller must ensure safety</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_getReturnUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Internal Usage by login()</p>
<pre class="prettyprint"><code class="language-php">// Called internally by login() method:
$returnUrl = self::getReturnUrl() ?? self::$afterLogoutUrl;
header('Location: ' . $returnUrl);
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Manual Retrieval (Rare)</p>
<pre class="prettyprint"><code class="language-php">$pendingUrl = AuthManager::getReturnUrl();
if ($pendingUrl) {
    echo &quot;You were trying to access: $pendingUrl&quot;;
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string|null</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The stored return URL, or null if none exists</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_getUserAuthWords">
        getUserAuthWords()
        <a href="classes/Primordyx-Security-AuthManager.html#method_getUserAuthWords" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">897</span>

    </aside>

        <p class="phpdocumentor-summary">Get array of authorization words (roles/permissions) for the current user</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">getUserAuthWords</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, string&gt;</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Retrieves all authorization words associated with the currently authenticated user
from the authorization words model. Authorization words are normalized to lowercase
and returned as a simple array for easy checking and iteration.</p>
<h2>Database Query Process</h2>
<ul>
<li>Verifies user authentication status first</li>
<li>Queries auth words model filtering by current user ID</li>
<li>Extracts and normalizes authorization word values</li>
<li>Returns empty array if not authenticated or no authorizations found</li>
</ul>
<h2>Authorization Word Format</h2>
<ul>
<li>All returned values are lowercase for consistency</li>
<li>Duplicates are automatically removed by database constraints</li>
<li>Array values are strings representing role/permission names</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_getUserAuthWords#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If auth words model is not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Display User Roles</p>
<pre class="prettyprint"><code class="language-php">$permissions = AuthManager::getUserAuthWords();
if (!empty($permissions)) {
    echo &quot;Your roles: &quot; . implode(', ', $permissions);
    // Output: &quot;Your roles: admin, user, manager&quot;
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Check Specific Permission</p>
<pre class="prettyprint"><code class="language-php">$permissions = AuthManager::getUserAuthWords();
if (in_array('admin', $permissions)) {
    echo &quot;User has admin role&quot;;
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array&lt;string|int, string&gt;</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>Array of lowercase authorization words, or empty array if not authenticated</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_isAuthorized">
        isAuthorized()
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorized" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">691</span>

    </aside>

        <p class="phpdocumentor-summary">Check if current authenticated user has a specific authorization word (role/permission)</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">isAuthorized</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$authWord</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Verifies both user authentication and specific authorization. Authorization words
are case-insensitive and automatically normalized to lowercase for consistent
matching across the application.</p>
<h2>Authorization Logic</h2>
<ul>
<li>First ensures user is logged in with valid session</li>
<li>Retrieves all user authorization words from database</li>
<li>Performs case-insensitive comparison with requested auth word</li>
<li>Returns false immediately if user is not authenticated</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$authWord</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The authorization word (role/permission) to check for</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorized#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If auth words model is not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Admin Panel Access</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorized('admin')) {
    // User has admin privileges
    showAdminPanel();
} else {
    echo &quot;Admin access required&quot;;
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Manager Tools Access</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorized('manager')) {
    // User has manager privileges
    showManagerTools();
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">bool</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>True if user is authenticated AND has the specified authorization</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_isAuthorizedAll">
        isAuthorizedAll()
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAll" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">788</span>

    </aside>

        <p class="phpdocumentor-summary">Check if user has all of the specified authorization words (AND logic)</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">isAuthorizedAll</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, string&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$authWords</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Evaluates multiple authorization words with AND logic - returns true only if the user
has ALL of the provided authorization words. Useful for &quot;admin AND finance&quot; type
access control where multiple specific permissions are required.</p>
<h2>AND Logic Implementation</h2>
<ul>
<li>Iterates through all provided authorization words</li>
<li>Returns false immediately when first missing authorization is found</li>
<li>All authorization words are normalized to lowercase</li>
<li>Short-circuits on first failed match for performance</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$authWords</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, string&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array of authorization words that must all be present</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAll#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If auth words model is not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Financial Admin Access</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorizedAll(['admin', 'finance'])) {
    // User has both admin AND finance privileges
    showFinancialAdminTools();
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Complex Permission Requirements</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorizedAll(['manager', 'hr', 'payroll'])) {
    // User has all three specific privileges
    showPayrollManagement();
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">bool</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>True if user is authenticated AND has all specified authorizations</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_isAuthorizedAny">
        isAuthorizedAny()
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAny" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">736</span>

    </aside>

        <p class="phpdocumentor-summary">Check if user has at least one of the specified authorization words (OR logic)</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">isAuthorizedAny</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, string&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$authWords</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Evaluates multiple authorization words with OR logic - returns true if the user
has ANY of the provided authorization words. Useful for &quot;admin OR manager&quot; type
access control where multiple roles can access the same resource.</p>
<h2>OR Logic Implementation</h2>
<ul>
<li>Iterates through provided authorization words</li>
<li>Returns true immediately when first match is found</li>
<li>All authorization words are normalized to lowercase</li>
<li>Short-circuits on first successful match for performance</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$authWords</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, string&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array of authorization words to check for</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAny#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If auth words model is not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Leadership Dashboard Access</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorizedAny(['admin', 'manager', 'supervisor'])) {
    // User has at least one leadership role
    showLeadershipDashboard();
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Multiple Role Options</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isAuthorizedAny(['admin', 'manager'])) {
    // User has admin OR manager privileges
    showManagementTools();
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">bool</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>True if user is authenticated AND has at least one specified authorization</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_isLoggedIn">
        isLoggedIn()
        <a href="classes/Primordyx-Security-AuthManager.html#method_isLoggedIn" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">629</span>

    </aside>

        <p class="phpdocumentor-summary">Check if user is currently authenticated with a valid, non-expired session</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">isLoggedIn</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Performs comprehensive session validation including existence check, timeout
verification, and activity timestamp updates. This method is the authoritative
way to determine if a user has valid authentication credentials.</p>
<h2>Validation Process</h2>
<ol>
<li>Verifies user ID exists in Safe session storage</li>
<li>Checks if session has exceeded inactivity timeout duration</li>
<li>Updates last activity timestamp for valid sessions</li>
<li>Redirects to timeout URL if session has expired</li>
</ol>
<h2>Session Timeout Handling</h2>
<ul>
<li>Compares current time against stored last activity timestamp</li>
<li>Automatically redirects to timeout URL with flash message if expired</li>
<li>Updates activity timestamp to current time for valid sessions</li>
<li>Uses configured <code class="prettyprint">timeoutSeconds</code> for inactivity threshold</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_isLoggedIn#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Basic Authentication Check</p>
<pre class="prettyprint"><code class="language-php">if (AuthManager::isLoggedIn()) {
    // User is authenticated and session is valid
    $user = AuthManager::user();
    echo &quot;Welcome, &quot; . $user-&gt;username;
} else {
    // Not authenticated or session expired
    AuthManager::forceLogin('Please log in to continue');
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Page Guard Pattern</p>
<pre class="prettyprint"><code class="language-php">if (!AuthManager::isLoggedIn()) {
    AuthManager::setReturnUrl($_SERVER['REQUEST_URI']);
    AuthManager::forceLogin('Please log in to access this page');
}
// Page content here - only reached by authenticated users
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">bool</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>True if user has valid authentication, false if not logged in</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_lockedOutUrl">
        lockedOutUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_lockedOutUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">281</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the URL where locked-out users are redirected for notification</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">lockedOutUrl</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When a user attempts to login but their account is currently locked due to
too many failed attempts, they will be redirected to this URL with an
appropriate flash message explaining the lockout.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the locked out URL and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_lockedOutUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Default Usage</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::lockedOutUrl();         // Get current URL
echo &quot;Lockout page: $current&quot;;                  // Shows '/locked.php' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Custom Lockout Page</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::lockedOutUrl('/auth/account-locked.php');
echo &quot;Lockout page changed from: $old&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current locked out URL (if getting) or previous URL (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_lockoutTime">
        lockoutTime()
        <a href="classes/Primordyx-Security-AuthManager.html#method_lockoutTime" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">249</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the lockout duration in seconds after exceeding max login attempts</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">lockoutTime</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$seconds</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When a user account is locked due to too many failed attempts, they will be
prevented from attempting to login again for this duration.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$seconds</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets lockout time and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_lockoutTime#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Lockout Duration</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::lockoutTime();          // Returns current duration
$minutes = $current / 60;                       // Convert to minutes
echo &quot;Lockout duration: $minutes minutes&quot;;      // Shows '15 minutes' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set 30 Minute Lockout</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::lockoutTime(1800);          // 30 minutes in seconds
echo &quot;Lockout changed from &quot; . ($old/60) . &quot; to 30 minutes&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">int</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current lockout time in seconds (if getting) or previous lockout time (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_login">
        login()
        <a href="classes/Primordyx-Security-AuthManager.html#method_login" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">497</span>

    </aside>

        <p class="phpdocumentor-summary">Attempt to authenticate user with username and password - always redirects, never returns</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">login</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$username</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$password</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">never</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Handles complete login workflow including password verification, failed attempt tracking,
account lockout enforcement, and session creation. This method performs all authentication
logic and always redirects the user to either a success or failure destination.</p>
<h2>Successful Login Process</h2>
<ul>
<li>Resets failed attempt counters in database</li>
<li>Creates secure session using Safe class</li>
<li>Redirects to return URL (if set) or configured success destination</li>
</ul>
<h2>Failed Login Process</h2>
<ul>
<li>Increments failed attempt counter in database</li>
<li>Applies account lockout if max attempts exceeded</li>
<li>Redirects to login page with appropriate error flash message</li>
</ul>
<h2>Security Features</h2>
<ul>
<li>Uses <code class="prettyprint">password_verify()</code> for secure password comparison</li>
<li>Protects against timing attacks through consistent processing</li>
<li>Enforces account lockouts to prevent brute force attacks</li>
<li>Cleans up stale session data before creating new session</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$username</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The username to authenticate against</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$password</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The plaintext password to verify (never stored)</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_login#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If user or auth words models aren't configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Login Form Processing</p>
<pre class="prettyprint"><code class="language-php">if ($_POST['login']) {
    AuthManager::login($_POST['username'], $_POST['password']);
    // Code below this line never executes - user is redirected
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>With Return URL</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setReturnUrl('/admin/dashboard');
AuthManager::login($username, $password);
// User goes to dashboard on success, login page on failure
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">never</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>This method never returns - always redirects and calls exit</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_loginUrl">
        loginUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_loginUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">186</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the login URL where users are redirected for authentication</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">loginUrl</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>This URL is used whenever the system needs to redirect users for authentication,
such as when using <code class="prettyprint">forceLogin()</code> or when authentication is required but not present.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the login URL and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_loginUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Login URL</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::loginUrl();              // Returns current URL
echo &quot;Login page: $current&quot;;                     // Shows '/login.php' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set New Login URL</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::loginUrl('/new-login.php');  // Set new URL, get old one back
echo &quot;Changed from: $old&quot;;                       // Shows previous URL
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current login URL (if getting) or previous login URL (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_logout">
        logout()
        <a href="classes/Primordyx-Security-AuthManager.html#method_logout" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">572</span>

    </aside>

        <p class="phpdocumentor-summary">Log out current user, clean up all session data, and redirect - never returns</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">logout</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">never</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Performs complete logout workflow including session cleanup, return URL clearing,
and user notification. This method ensures all authentication-related data is
properly removed from the session to prevent security issues.</p>
<h2>Logout Process</h2>
<ul>
<li>Removes all authentication data from Safe session storage</li>
<li>Clears saved return URLs to prevent stale redirects</li>
<li>Sets success flash message for user feedback</li>
<li>Redirects to configured after-logout URL and exits</li>
</ul>
<h2>Security Considerations</h2>
<ul>
<li>Completely clears session authentication state</li>
<li>Prevents session fixation by removing all auth data</li>
<li>Cleans up potentially stale return URL redirects</li>
<li>Provides clear feedback that logout was successful</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_logout#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Simple Logout</p>
<pre class="prettyprint"><code class="language-php">AuthManager::logout();
// User is redirected to after-logout page - code below never runs
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>In Logout Handler</p>
<pre class="prettyprint"><code class="language-php">if ($_POST['logout'] || $_GET['logout']) {
    AuthManager::logout();
    // Automatic redirect to configured destination
}
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">never</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>This method never returns - always redirects and calls exit</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_maxLoginAttempts">
        maxLoginAttempts()
        <a href="classes/Primordyx-Security-AuthManager.html#method_maxLoginAttempts" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">217</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the maximum login attempts before triggering account lockout</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">maxLoginAttempts</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$attempts</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When a user exceeds this number of failed login attempts, their account will be
temporarily locked for the duration specified by <code class="prettyprint">lockoutTime()</code>.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$attempts</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets max attempts and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_maxLoginAttempts#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Max Attempts</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::maxLoginAttempts();     // Returns current limit
echo &quot;Max attempts: $current&quot;;                  // Shows '5' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set Stricter Limit</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::maxLoginAttempts(3);        // Allow only 3 attempts
echo &quot;Attempts limit changed from $old to 3&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">int</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current max attempts (if getting) or previous max attempts (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_requireAuth">
        requireAuth()
        <a href="classes/Primordyx-Security-AuthManager.html#method_requireAuth" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1067</span>

    </aside>

        <p class="phpdocumentor-summary">Enforce authentication and optional authorization requirements - redirects if not met</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">requireAuth</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|array&lt;string|int, string&gt;|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$requiredAuthWord</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Provides declarative access control by checking authentication and authorization
requirements. If requirements are not met, automatically redirects with appropriate
flash messages. This method never returns when access is denied.</p>
<h2>Access Control Logic</h2>
<ul>
<li>Always requires valid authentication (logged-in user)</li>
<li>Optionally requires specific authorization word(s)</li>
<li>Supports both single auth word and multiple auth words (ANY logic)</li>
<li>Sets appropriate flash messages before redirect</li>
<li>Does NOT automatically set return URLs (controller responsibility)</li>
</ul>
<h2>Authorization Modes</h2>
<ul>
<li>No auth word: Requires login only</li>
<li>Single string: Requires specific authorization word</li>
<li>Array of strings: Requires ANY of the authorization words (OR logic)</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$requiredAuthWord</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|array&lt;string|int, string&gt;|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Single auth word, array of auth words, or null for login-only</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_requireAuth#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If models are not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Require Login Only</p>
<pre class="prettyprint"><code class="language-php">AuthManager::requireAuth();
// Code below only runs for authenticated users
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Require Specific Role</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setReturnUrl($_SERVER['REQUEST_URI']);
AuthManager::requireAuth('admin');
// Only admin users can access this code
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Require Multiple Role Options</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setReturnUrl($_SERVER['REQUEST_URI']);
AuthManager::requireAuth(['admin', 'manager']);
// Admin OR manager users can access this code
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">void</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>Returns normally if access granted, redirects and exits if denied</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_setFlash">
        setFlash()
        <a href="classes/Primordyx-Security-AuthManager.html#method_setFlash" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">962</span>

    </aside>

        <p class="phpdocumentor-summary">Set flash message for display after redirect (consumed on next request)</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">setFlash</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$type</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$message</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Flash messages provide user feedback across HTTP redirects by storing the message
in the session temporarily. Messages are automatically consumed (removed) when
retrieved with <code class="prettyprint">getFlash()</code>, ensuring they display exactly once.</p>
<h2>Flash Message Lifecycle</h2>
<ul>
<li>Message is stored in Safe session using flash storage</li>
<li>Survives exactly one HTTP redirect cycle</li>
<li>Automatically removed when retrieved with <code class="prettyprint">getFlash()</code></li>
<li>Perfect for post-redirect-get pattern feedback</li>
</ul>
<h2>Common Message Types</h2>
<ul>
<li><code class="prettyprint">success</code> - Green/positive feedback (login success, save confirmation)</li>
<li><code class="prettyprint">error</code> - Red/negative feedback (login failure, validation errors)</li>
<li><code class="prettyprint">warning</code> - Yellow/caution feedback (session timeout, deprecated features)</li>
<li><code class="prettyprint">info</code> - Blue/informational feedback (tips, announcements)</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$type</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Message type for CSS styling (success, error, warning, info)</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$message</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The actual message content to display to the user</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_setFlash#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Success Messages</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setFlash('success', 'Profile updated successfully!');
AuthManager::setFlash('success', 'Password changed successfully!');
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Error Messages</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setFlash('error', 'Invalid username or password.');
AuthManager::setFlash('error', 'Account is temporarily locked.');
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Warning and Info Messages</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setFlash('warning', 'Session will expire in 5 minutes.');
AuthManager::setFlash('info', 'New features are now available.');
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_setReturnUrl">
        setReturnUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_setReturnUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1136</span>

    </aside>

        <p class="phpdocumentor-summary">Set return URL for post-login redirect to user&#039;s intended destination</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">setReturnUrl</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Stores a URL in the session that will be used as the redirect destination after
successful login. This allows users to return to their intended page after being
forced to authenticate, improving user experience by maintaining navigation context.</p>
<h2>URL Management Strategy</h2>
<ul>
<li>Overwrites any existing return URL in session</li>
<li>URL persists until login success or session timeout</li>
<li>Automatically cleared after successful login to prevent reuse</li>
<li>Should be called before redirecting user to login page</li>
</ul>
<h2>Security Considerations</h2>
<ul>
<li>No validation performed on URL format (trusts caller)</li>
<li>Caller responsible for sanitizing URLs if needed</li>
<li>URLs can be relative or absolute paths</li>
<li>Return URLs are cleared on logout to prevent stale redirects</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The destination URL where user should be sent after login</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_setReturnUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Standard Page Protection</p>
<pre class="prettyprint"><code class="language-php">AuthManager::setReturnUrl($_SERVER['REQUEST_URI']);
AuthManager::requireAuth('admin');
// User returns to exact same page after login
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Secure Redirect Strategy</p>
<pre class="prettyprint"><code class="language-php">if ($sensitiveAction) {
    AuthManager::setReturnUrl('/admin/dashboard');  // Safe destination
} else {
    AuthManager::setReturnUrl($_SERVER['REQUEST_URI']); // Original page
}
AuthManager::forceLogin();
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_timeoutSeconds">
        timeoutSeconds()
        <a href="classes/Primordyx-Security-AuthManager.html#method_timeoutSeconds" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">375</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the session timeout duration in seconds for inactivity-based logout</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">timeoutSeconds</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$seconds</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When a user's session is inactive for longer than this duration, they will
be automatically logged out and redirected to the timeout URL on their next request.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$seconds</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the timeout duration and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_timeoutSeconds#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Timeout</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::timeoutSeconds();       // Get current timeout
$hours = $current / 3600;                       // Convert to hours
echo &quot;Session timeout: $hours hours&quot;;           // Shows '1 hours' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set 2 Hour Timeout</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::timeoutSeconds(7200);       // 2 hours, get old timeout
echo &quot;Timeout changed from &quot; . ($old/3600) . &quot; to 2 hours&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">int</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current timeout in seconds (if getting) or previous timeout (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_timeoutUrl">
        timeoutUrl()
        <a href="classes/Primordyx-Security-AuthManager.html#method_timeoutUrl" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">343</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the URL where users are redirected when their session times out</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">timeoutUrl</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>When a user's session expires due to inactivity (exceeds <code class="prettyprint">timeoutSeconds()</code>),
they will be redirected to this URL with appropriate notification.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the timeout URL and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_timeoutUrl#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Timeout Destination</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::timeoutUrl();           // Get current URL
echo &quot;Timeout page: $current&quot;;                  // Shows '/timeout.php' (default)
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Custom Timeout Page</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::timeoutUrl('/auth/session-expired.php');
echo &quot;Timeout destination changed from: $old&quot;;
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current timeout URL (if getting) or previous URL (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_user">
        user()
        <a href="classes/Primordyx-Security-AuthManager.html#method_user" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">845</span>

    </aside>

        <p class="phpdocumentor-summary">Get the current authenticated user&#039;s model instance from the database</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">user</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Retrieves the complete user record from the database for the currently authenticated
user. This method first verifies authentication, then fetches the full user model
with all available fields and relationships.</p>
<h2>Database Query Process</h2>
<ul>
<li>Verifies user authentication with <code class="prettyprint">isLoggedIn()</code> check</li>
<li>Extracts user ID from Safe session storage</li>
<li>Queries user model using the stored user ID</li>
<li>Returns null if not authenticated or user record not found</li>
</ul>
<h2>Use Cases</h2>
<ul>
<li>Displaying user profile information</li>
<li>Accessing user preferences and settings</li>
<li>Checking user-specific database fields</li>
<li>Audit logging with user context</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_user#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If user model is not configured</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Display User Information</p>
<pre class="prettyprint"><code class="language-php">$user = AuthManager::user();
if ($user) {
    echo &quot;Welcome, &quot; . htmlspecialchars($user-&gt;username);
    echo &quot;Email: &quot; . htmlspecialchars($user-&gt;email);
    echo &quot;Member since: &quot; . $user-&gt;created_at;
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Safe Chaining (PHP 8+)</p>
<pre class="prettyprint"><code class="language-php">$username = AuthManager::user()?-&gt;username ?? 'Guest';
$isVerified = AuthManager::user()?-&gt;email_verified ?? false;
</code></pre>
</section>

                                    </dd>
                                            </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The complete user model instance, or null if not authenticated</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_userAuthWordsModel">
        userAuthWordsModel()
        <a href="classes/Primordyx-Security-AuthManager.html#method_userAuthWordsModel" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">443</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the user authorization words model for role-based access control</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">userAuthWordsModel</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$model</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>The auth words model manages the many-to-many relationship between users and
their authorization words (roles/permissions). Must support user_id and auth_word fields.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$model</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the auth words model and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_userAuthWordsModel#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If model doesn't support required authorization fields</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Model</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::userAuthWordsModel();   // Get current model
if ($current) {
    echo &quot;Auth model: &quot; . get_class($current);
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set Authorization Model</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::userAuthWordsModel(new UserAuthWords());
echo &quot;Auth model changed from: &quot; . ($old ? get_class($old) : 'none');
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current auth words model (if getting) or previous model (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_userModel">
        userModel()
        <a href="classes/Primordyx-Security-AuthManager.html#method_userModel" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">409</span>

    </aside>

        <p class="phpdocumentor-summary">Get or set the user model instance for database authentication operations</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">userModel</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null&nbsp;</span><span class="phpdocumentor-signature__argument__name">$model</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>The user model must support the Primordyx Model interface and should have fields
for username, password_hash, failed_attempts, last_failed, and locked_until.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$model</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>If provided, sets the user model and returns the previous value</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_userModel#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If model doesn't support required authentication fields</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Get Current Model</p>
<pre class="prettyprint"><code class="language-php">$current = AuthManager::userModel();            // Get current model
if ($current) {
    echo &quot;Using model: &quot; . get_class($current);
}
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Set User Model</p>
<pre class="prettyprint"><code class="language-php">$old = AuthManager::userModel(new User());      // Set new model, get old one back
echo &quot;Model changed from: &quot; . ($old ? get_class($old) : 'none');
</code></pre>
</section>

                                    </dd>
                        </dl>

    

            <section>
        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>|null</span>
                    &mdash;
                <section class="phpdocumentor-description"><p>The current user model (if getting) or previous model (if setting)</p>
</section>

            </section>

</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_ensureModelsConfigured">
        ensureModelsConfigured()
        <a href="classes/Primordyx-Security-AuthManager.html#method_ensureModelsConfigured" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1381</span>

    </aside>

        <p class="phpdocumentor-summary">Ensure required models are configured before performing database operations</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">ensureModelsConfigured</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Validates that both the user model and user authorization words model have been
properly set via the configuration methods. Throws descriptive runtime exceptions
if either model is missing.</p>
<h2>Validation Process</h2>
<ol>
<li>Checks if user model is set (for authentication)</li>
<li>Checks if auth words model is set (for authorization)</li>
<li>Throws RuntimeException with clear instructions if missing</li>
</ol>
<h2>Configuration Requirements</h2>
<p>Models must be configured before any authentication operations:</p>
<ul>
<li>User model: Handles user records and authentication</li>
<li>Auth words model: Handles user permissions/roles</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_ensureModelsConfigured#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\RuntimeException">RuntimeException</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If user model or auth words model is not configured</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Bootstrap Configuration</p>
<pre class="prettyprint"><code class="language-php">// Configure models in bootstrap to avoid exceptions:
AuthManager::userModel(new User());
AuthManager::userAuthWordsModel(new UserAuthWords());
</code></pre>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Exception Messages</p>
<pre class="prettyprint"><code class="language-php">// If user model not set:
// &quot;User model must be set using AuthManager::userModel() before use.&quot;

// If auth words model not set:
// &quot;UserAuthWords model must be set using AuthManager::userAuthWordsModel() before use.&quot;
</code></pre>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">used-by</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Various AuthManager methods that require database access</p>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_handleFailedLogin">
        handleFailedLogin()
        <a href="classes/Primordyx-Security-AuthManager.html#method_handleFailedLogin" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1272</span>

    </aside>

        <p class="phpdocumentor-summary">Handle failed login attempt by updating attempt counters and applying lockouts</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">handleFailedLogin</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Increments the failed attempt counter, records the failure timestamp, and applies
account lockout if the maximum attempts threshold is exceeded. Sets appropriate
flash messages indicating remaining attempts or lockout status.</p>
<h2>Failed Login Process</h2>
<ol>
<li>Increments failed_attempts counter in user record</li>
<li>Updates last_failed timestamp to current time</li>
<li>Checks if max attempts exceeded</li>
<li>If exceeded, sets locked_until timestamp for lockout period</li>
<li>Sets appropriate flash message for user feedback</li>
<li>Saves updated user record to database</li>
</ol>
<h2>Flash Message Logic</h2>
<ul>
<li>Under limit: Shows remaining attempts count</li>
<li>At limit: Indicates account is now locked</li>
<li>Provides clear feedback about security status</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The user model instance to update</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_handleFailedLogin#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If database operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Called by login() Method</p>
<pre class="prettyprint"><code class="language-php">// Automatically called when password verification fails:
if (!password_verify($password, $user-&gt;password_hash)) {
    self::handleFailedLogin($user);
    header('Location: ' . self::$loginUrl);
    exit;
}
</code></pre>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">used-by</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>AuthManager::login() Called automatically on password failure</p>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_handleSuccessfulLogin">
        handleSuccessfulLogin()
        <a href="classes/Primordyx-Security-AuthManager.html#method_handleSuccessfulLogin" class="headerlink"><i class="fas fa-link"></i></a>

    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="src/Security/AuthManager.php"><a href="files/src-security-authmanager.html"><abbr title="src/Security/AuthManager.php">AuthManager.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1326</span>

    </aside>

        <p class="phpdocumentor-summary">Handle successful login by resetting failure counters and creating session</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">handleSuccessfulLogin</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

    <div class="phpdocumentor-label-line">
        </div>
    
        <section class="phpdocumentor-description"><p>Resets all failed login tracking fields, creates the authenticated session
in Safe storage, and sets a welcome flash message. Called automatically
after successful password verification.</p>
<h2>Successful Login Process</h2>
<ol>
<li>Resets failed_attempts counter to 0</li>
<li>Clears last_failed timestamp</li>
<li>Clears locked_until timestamp</li>
<li>Saves cleaned user record to database</li>
<li>Creates authenticated session with user ID</li>
<li>Sets last_activity timestamp for timeout tracking</li>
<li>Sets login_time timestamp for session duration tracking</li>
<li>Sets welcome flash message with username</li>
</ol>
<h2>Session Data Created</h2>
<ul>
<li><code class="prettyprint">auth_user_id</code> - User's database ID for identity</li>
<li><code class="prettyprint">auth_last_activity</code> - Timestamp for timeout checking</li>
<li><code class="prettyprint">auth_login_time</code> - Timestamp for session duration</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href="classes/Primordyx-Database-Model.html"><abbr title="\Primordyx\Database\Model">Model</abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The user model instance to update and create session for</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="classes/Primordyx-Security-AuthManager.html#method_handleSuccessfulLogin#tags" class="headerlink"><i class="fas fa-link"></i></a>

    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><abbr title="\Exception">Exception</abbr></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If Safe session operations fail</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">since</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                            <span class="phpdocumentor-tag-link">1.0.0</span>
                                                                                
                                             
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">example</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>Called by login() Method</p>
<pre class="prettyprint"><code class="language-php">// Automatically called after successful password verification:
if (password_verify($password, $user-&gt;password_hash)) {
    self::handleSuccessfulLogin($user);
    // Redirect to return URL or default
}
</code></pre>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">used-by</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>AuthManager::login() Called automatically on password success</p>
</section>

                                    </dd>
                                            </dl>

    

    
</article>
            </section>

        <div class="phpdocumentor-modal" id="source-view">
    <div class="phpdocumentor-modal-bg" data-exit-button></div>
    <div class="phpdocumentor-modal-container">
        <div class="phpdocumentor-modal-content">
            <pre style="max-height: 500px; overflow-y: scroll" data-src="files/src/Security/AuthManager.php.txt" class="language-php line-numbers linkable-line-numbers"></pre>
        </div>
        <button data-exit-button class="phpdocumentor-modal__close">&times;</button>
    </div>
</div>

    <script type="text/javascript">
        (function () {
            function loadExternalCodeSnippet(el, url, line) {
                Array.prototype.slice.call(el.querySelectorAll('pre[data-src]')).forEach((pre) => {
                    const src = url || pre.getAttribute('data-src').replace(/\\/g, '/');
                    const language = 'php';

                    const code = document.createElement('code');
                    code.className = 'language-' + language;
                    pre.textContent = '';
                    pre.setAttribute('data-line', line)
                    code.textContent = 'Loading';
                    pre.appendChild(code);

                    var xhr = new XMLHttpRequest();

                    xhr.open('GET', src, true);

                    xhr.onreadystatechange = function () {
                        if (xhr.readyState !== 4) {
                            return;
                        }

                        if (xhr.status < 400 && xhr.responseText) {
                            code.textContent = xhr.responseText;
                            Prism.highlightElement(code);
                            d=document.getElementsByClassName("line-numbers");
                            d[0].scrollTop = d[0].children[1].offsetTop;
                            return;
                        }

                        if (xhr.status === 404) {
                            code.textContent = ' Error: File could not be found';
                            return;
                        }

                        if (xhr.status >= 400) {
                            code.textContent = ' Error ' + xhr.status + ' while fetching file: ' + xhr.statusText;
                            return;
                        }

                        code.textContent = ' Error: An unknown error occurred';
                    };

                    xhr.send(null);
                });
            }

            const modalButtons = document.querySelectorAll("[data-modal]");
            const openedAsLocalFile = window.location.protocol === 'file:';
            if (modalButtons.length > 0 && openedAsLocalFile) {
                console.warn(
                    'Viewing the source code is unavailable because you are opening this page from the file:// scheme; ' +
                    'browsers block XHR requests when a page is opened this way'
                );
            }

            modalButtons.forEach(function (trigger) {
                if (openedAsLocalFile) {
                    trigger.setAttribute("hidden", "hidden");
                }

                trigger.addEventListener("click", function (event) {
                    event.preventDefault();
                    const modal = document.getElementById(trigger.dataset.modal);
                    if (!modal) {
                        console.error(`Modal with id "${trigger.dataset.modal}" could not be found`);
                        return;
                    }
                    modal.classList.add("phpdocumentor-modal__open");

                    loadExternalCodeSnippet(modal, trigger.dataset.src || null, trigger.dataset.line)
                    const exits = modal.querySelectorAll("[data-exit-button]");
                    exits.forEach(function (exit) {
                        exit.addEventListener("click", function (event) {
                            event.preventDefault();
                            modal.classList.remove("phpdocumentor-modal__open");
                        });
                    });
                });
            });
        })();
    </script>

    </article>
                                </section>
                <section class="phpdocumentor-on-this-page__sidebar">
                                
    <section class="phpdocumentor-on-this-page__content">
        <strong class="phpdocumentor-on-this-page__title">On this page</strong>

        <ul class="phpdocumentor-list -clean">
            <li class="phpdocumentor-on-this-page-section__title">Table Of Contents</li>
            <li>
                <ul class="phpdocumentor-list -clean">
                                                            <li><a href="classes/Primordyx-Security-AuthManager.html#toc-properties">Properties</a></li>
                                                            <li><a href="classes/Primordyx-Security-AuthManager.html#toc-methods">Methods</a></li>
                                    </ul>
            </li>
            
                            <li class="phpdocumentor-on-this-page-section__title">Properties</li>
                <li>
                    <ul class="phpdocumentor-list -clean">
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_afterLogoutUrl">$afterLogoutUrl</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_lockedOutUrl">$lockedOutUrl</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_lockoutTime">$lockoutTime</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_loginUrl">$loginUrl</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_maxLoginAttempts">$maxLoginAttempts</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_timeoutSeconds">$timeoutSeconds</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_timeoutUrl">$timeoutUrl</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_userAuthWordsModel">$userAuthWordsModel</a></li>
                                                    <li class=""><a href="classes/Primordyx-Security-AuthManager.html#property_userModel">$userModel</a></li>
                                            </ul>
                </li>
            
                        <li class="phpdocumentor-on-this-page-section__title">Methods</li>
            <li>
                <ul class="phpdocumentor-list -clean">
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_afterLogoutUrl">afterLogoutUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_config">config()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_forceLogin">forceLogin()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_getFlash">getFlash()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_getReturnUrl">getReturnUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_getUserAuthWords">getUserAuthWords()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorized">isAuthorized()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAll">isAuthorizedAll()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_isAuthorizedAny">isAuthorizedAny()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_isLoggedIn">isLoggedIn()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_lockedOutUrl">lockedOutUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_lockoutTime">lockoutTime()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_login">login()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_loginUrl">loginUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_logout">logout()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_maxLoginAttempts">maxLoginAttempts()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_requireAuth">requireAuth()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_setFlash">setFlash()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_setReturnUrl">setReturnUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_timeoutSeconds">timeoutSeconds()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_timeoutUrl">timeoutUrl()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_user">user()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_userAuthWordsModel">userAuthWordsModel()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_userModel">userModel()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_ensureModelsConfigured">ensureModelsConfigured()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_handleFailedLogin">handleFailedLogin()</a></li>
                                            <li class=""><a href="classes/Primordyx-Security-AuthManager.html#method_handleSuccessfulLogin">handleSuccessfulLogin()</a></li>
                                    </ul>
            </li>
                    </ul>
    </section>

                </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="classes/Primordyx-Security-AuthManager.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>
